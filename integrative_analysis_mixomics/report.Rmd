---
title: "Report with results from the 'IODA (Mixomics part)' in targets' mode (v.1)"
author: Ferran Brianso
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    toc: true
    toc_float: TRUE
    theme: united
---

Targets' report corresponding to the functions that execute de Mixomics part of the IODA pipeline...

```{r libraries, include=FALSE, echo=FALSE}
library(ggplot2)
library(targets)
library(stats)
library(mixOmics)

```

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 110)
```

## Raw data (before data prep) 

Data loaded from file **`r p.inFile`**
(Features in rows; Samples in columns)

```{r out.width = '95%', echo=FALSE}
tar_read(gene_data)[1:10,1:8]
tar_read(prot_data)[1:10,1:8]
```

```{r out.width = '95%', echo=FALSE}
hist(gene_data)
hist(prot_data)
```

## Data after scaling

(Features in rows; Samples in columns)

```{r out.width = '95%', echo=FALSE}
tar_read(gene_sc)[1:10,1:8]
tar_read(prot_sc)[1:10,1:8]
```

```{r out.width = '95%', echo=FALSE}
hist(gene_sc)
hist(prot_sc)
```

## Correlation matrix

```{r corr-plot, out.width = '95%'}
plot_corr_matrix(tar_read(X), tar_read(Y), p.resultsDir)
```
![Correlation matrix](./results/mixomics/corrMatrix.png)

## rCCA results

```{r rCCA-results, out.width = '95%'}
tar_read(rCCA)
```

### Individual samples plot
```{r indiv-plot, out.width = '95%'}
plot_indiv(tar_read(rCCA), p.resultsDir)
```


### Correlation circles plots
Correlation circles plots (at **cutoff points: `r p.circ.cutOffs`**)

```{r corrCirc-plot, out.width = '80%'}
for(i in 1:length(p.circ.cutOffs)){
  plot_corrCirc(tar_read(rCCA), p.resultsDir, cutOff = p.circ.cutOffs[i])
}
```


### Correlation network
```{r rCCA-network, out.width = '95%'}
str(tar_read(rCCA_network))
```
![Correlation network](./results/mixomics/relNetwork0.5.png)

### CIM heatmap
```{r CIM-plot, out.width = '95%'}
plot_cim(tar_read(rCCA_tagged), p.resultsDir, x.lab = p.x.lab, y.lab = p.y.lab) 
```
![CIM Heatmap](./results/mixomics/cimHeatMap.png)
